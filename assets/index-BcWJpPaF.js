(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function t(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(a){if(a.ep)return;a.ep=!0;const s=t(a);fetch(a.href,s)}})();const j=["チャプター1","面白かったところ","重要なポイント","質問"],k="timestampLogs",P="youtubeApiKey",N="memoPatterns",O="timeOffset",u="collapsedState_",v=document.getElementById("memo-patterns-header"),M=document.getElementById("memo-patterns-content"),A=document.getElementById("memo-patterns-list"),_=document.getElementById("new-memo-pattern-input"),x=document.getElementById("add-memo-pattern-button"),C=document.getElementById("memo-buttons-container"),F=document.getElementById("log-output"),U=document.getElementById("reset-button"),E=document.getElementById("live-stream-header"),$=document.getElementById("live-stream-content"),G=document.getElementById("channel-id-input"),H=document.getElementById("fetch-live-streams-button"),p=document.getElementById("live-stream-ids-output"),J=document.getElementById("youtube-url"),g=document.getElementById("time-offset-input"),d=document.getElementById("api-key"),l=document.getElementById("convert-button"),I=document.getElementById("youtube-timestamps"),z=document.getElementById("copy-button");let i=[],c=[];const h=()=>{A.innerHTML="",c.forEach((e,n)=>{const t=document.createElement("div");t.className="memo-pattern-item",t.textContent=e;const o=document.createElement("button");o.textContent="×",o.addEventListener("click",()=>{q(n)}),t.appendChild(o),A.appendChild(t)})},R=()=>{localStorage.setItem(N,JSON.stringify(c))},Z=()=>{const e=_.value.trim();e&&!c.includes(e)&&(c.push(e),R(),h(),T(),_.value="")},q=e=>{c.splice(e,1),R(),h(),T()},S=()=>{const e=t=>new Intl.DateTimeFormat("ja-JP",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1,timeZone:"Asia/Tokyo"}).format(new Date(t)),n=i.map(t=>`[${e(t.timestamp)}] ${t.memo}`).join(`
`);F.value=n,localStorage.setItem(k,JSON.stringify(i))},V=e=>{const n={timestamp:Date.now(),memo:e};i.push(n),i.sort((t,o)=>t.timestamp-o.timestamp),S()},T=()=>{C.innerHTML="",c.forEach(e=>{const n=document.createElement("button");n.textContent=e,n.addEventListener("click",()=>V(e)),C.appendChild(n)})},X=e=>{const n=/(?:youtube\.com\/(?:watch\?v=|embed\/|live\/)|youtu\.be\/)([a-zA-Z0-9_-]{11})/,t=e.match(n);return t?t[1]:null},y=e=>{const n=Math.floor(e/3600),t=Math.floor(e%3600/60),o=Math.floor(e%60),a=String(n).padStart(2,"0"),s=String(t).padStart(2,"0"),r=String(o).padStart(2,"0");return`${a}:${s}:${r}`},Q=async()=>{var t;const e=G.value.trim(),n=d.value;if(!e){alert("YouTube Channel IDを入力してください。");return}if(!n){alert("YouTube Data APIキーを入力してください。");return}p.value="取得中...";try{const o=`https://www.googleapis.com/youtube/v3/search?part=snippet&channelId=${e}&eventType=live&type=video&key=${n}`,a=await fetch(o),s=await a.json();if(!a.ok||s.error)throw new Error(((t=s.error)==null?void 0:t.message)||"ライブ配信情報の取得に失敗しました。");if(s.items.length===0)p.value="現在ライブ配信中の動画はありません。";else{const r=s.items.map(m=>m.id.videoId).join(`
`);p.value=r}}catch(o){p.value=`エラーが発生しました: ${o instanceof Error?o.message:String(o)}`}finally{}},W=async()=>{var a;const e=J.value,n=d.value,t=X(e),o=parseInt(g.value||"0",10);if(!t){alert("有効なYouTubeのURLを入力してください。");return}if(!n){alert("YouTube Data APIキーを入力してください。");return}try{l.textContent="変換中...",l.disabled=!0;const s=`https://www.googleapis.com/youtube/v3/videos?id=${t}&part=liveStreamingDetails&key=${n}`,r=await fetch(s),m=await r.json();if(!r.ok||m.items.length===0)throw new Error(((a=m.error)==null?void 0:a.message)||"動画情報の取得に失敗しました。");const f=m.items[0].liveStreamingDetails,L=f==null?void 0:f.actualStartTime;if(!L)throw new Error(`ライブ配信の開始時刻が取得できませんでした。アーカイブ動画ではない可能性があります。
(ライブ配信終了直後は情報が反映されていない場合があります。しばらく待ってからお試しください。)`);const Y=new Date(L).getTime(),b=i.map(w=>{const B=(w.timestamp+o*1e3-Y)/1e3;return`${B>0?y(B):y(0)} ${w.memo}`});b.unshift(`${y(0)} 配信開始`),I.value=b.join(`
`)}catch(s){alert(`エラーが発生しました: ${s instanceof Error?s.message:String(s)}`)}finally{l.textContent="変換実行",l.disabled=!1}},K=(e,n,t)=>{const o=n.classList.toggle("collapsed");e.classList.toggle("collapsed",o),localStorage.setItem(t,o.toString())},D=(e,n,t)=>{localStorage.getItem(t)==="true"&&(n.classList.add("collapsed"),e.classList.add("collapsed"))},ee=()=>{const e=localStorage.getItem(k);e&&(i=JSON.parse(e),S());const n=localStorage.getItem(P);n&&(d.value=n);const t=localStorage.getItem(N);t?c=JSON.parse(t):c=[...j];const o=localStorage.getItem(O);o!==null&&(g.value=o),h(),T(),x.addEventListener("click",Z),U.addEventListener("click",()=>{confirm("本当にすべてのログをリセットしますか？")&&(i=[],S())}),H.addEventListener("click",Q),l.addEventListener("click",W),z.addEventListener("click",()=>{I.value&&(navigator.clipboard.writeText(I.value),alert("クリップボードにコピーしました。"))}),d.addEventListener("change",()=>{localStorage.setItem(P,d.value)}),g.addEventListener("change",()=>{localStorage.setItem(O,g.value)}),v.addEventListener("click",()=>K(v,M,u+"memoPatterns")),D(v,M,u+"memoPatterns"),E.addEventListener("click",()=>K(E,$,u+"liveStream")),D(E,$,u+"liveStream")};ee();
