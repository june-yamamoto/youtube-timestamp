(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();const C=["チャプター1","面白かったところ","重要なポイント","質問"],M="timestampLogs",w="youtubeApiKey",A="memoPatterns",L="timeOffset",O=document.getElementById("memo-patterns-list"),B=document.getElementById("new-memo-pattern-input"),K=document.getElementById("add-memo-pattern-button"),P=document.getElementById("memo-buttons-container"),D=document.getElementById("log-output"),N=document.getElementById("reset-button"),Y=document.getElementById("channel-id-input"),j=document.getElementById("fetch-live-streams-button"),l=document.getElementById("live-stream-ids-output"),k=document.getElementById("youtube-url"),p=document.getElementById("time-offset-input"),u=document.getElementById("api-key"),d=document.getElementById("convert-button"),v=document.getElementById("youtube-timestamps"),x=document.getElementById("copy-button");let c=[],i=[];const E=()=>{O.innerHTML="",i.forEach((e,n)=>{const t=document.createElement("div");t.className="memo-pattern-item",t.textContent=e;const r=document.createElement("button");r.textContent="×",r.addEventListener("click",()=>{U(n)}),t.appendChild(r),O.appendChild(t)})},_=()=>{localStorage.setItem(A,JSON.stringify(i))},R=()=>{const e=B.value.trim();e&&!i.includes(e)&&(i.push(e),_(),E(),h(),B.value="")},U=e=>{i.splice(e,1),_(),E(),h()},y=()=>{const e=t=>new Intl.DateTimeFormat("ja-JP",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1,timeZone:"Asia/Tokyo"}).format(new Date(t)),n=c.map(t=>`[${e(t.timestamp)}] ${t.memo}`).join(`
`);D.value=n,localStorage.setItem(M,JSON.stringify(c))},F=e=>{const n={timestamp:Date.now(),memo:e};c.push(n),c.sort((t,r)=>t.timestamp-r.timestamp),y()},h=()=>{P.innerHTML="",i.forEach(e=>{const n=document.createElement("button");n.textContent=e,n.addEventListener("click",()=>F(e)),P.appendChild(n)})},G=e=>{const n=/(?:youtube\.com\/(?:watch\?v=|embed\/|live\/)|youtu\.be\/)([a-zA-Z0-9_-]{11})/,t=e.match(n);return t?t[1]:null},g=e=>{const n=Math.floor(e/3600),t=Math.floor(e%3600/60),r=Math.floor(e%60),s=String(n).padStart(2,"0"),o=String(t).padStart(2,"0"),a=String(r).padStart(2,"0");return`${s}:${o}:${a}`},J=async()=>{var t;const e=Y.value.trim(),n=u.value;if(!e){alert("YouTube Channel IDを入力してください。");return}if(!n){alert("YouTube Data APIキーを入力してください。");return}l.value="取得中...";try{const r=`https://www.googleapis.com/youtube/v3/search?part=snippet&channelId=${e}&eventType=live&type=video&key=${n}`,s=await fetch(r),o=await s.json();if(!s.ok||o.error)throw new Error(((t=o.error)==null?void 0:t.message)||"ライブ配信情報の取得に失敗しました。");if(o.items.length===0)l.value="現在ライブ配信中の動画はありません。";else{const a=o.items.map(m=>m.id.videoId).join(`
`);l.value=a}}catch(r){l.value=`エラーが発生しました: ${r instanceof Error?r.message:String(r)}`}finally{}},H=async()=>{var s;const e=k.value,n=u.value,t=G(e),r=parseInt(p.value||"0",10);if(!t){alert("有効なYouTubeのURLを入力してください。");return}if(!n){alert("YouTube Data APIキーを入力してください。");return}try{d.textContent="変換中...",d.disabled=!0;const o=`https://www.googleapis.com/youtube/v3/videos?id=${t}&part=liveStreamingDetails&key=${n}`,a=await fetch(o),m=await a.json();if(!a.ok||m.items.length===0)throw new Error(((s=m.error)==null?void 0:s.message)||"動画情報の取得に失敗しました。");const f=m.items[0].liveStreamingDetails,I=f==null?void 0:f.actualStartTime;if(!I)throw new Error(`ライブ配信の開始時刻が取得できませんでした。アーカイブ動画ではない可能性があります。
(ライブ配信終了直後は情報が反映されていない場合があります。しばらく待ってからお試しください。)`);const $=new Date(I).getTime(),S=c.map(T=>{const b=(T.timestamp+r*1e3-$)/1e3;return`${b>0?g(b):g(0)} ${T.memo}`});S.unshift(`${g(0)} 配信開始`),v.value=S.join(`
`)}catch(o){alert(`エラーが発生しました: ${o instanceof Error?o.message:String(o)}`)}finally{d.textContent="変換実行",d.disabled=!1}},z=()=>{const e=localStorage.getItem(M);e&&(c=JSON.parse(e),y());const n=localStorage.getItem(w);n&&(u.value=n);const t=localStorage.getItem(A);t?i=JSON.parse(t):i=[...C];const r=localStorage.getItem(L);r!==null&&(p.value=r),E(),h(),K.addEventListener("click",R),N.addEventListener("click",()=>{confirm("本当にすべてのログをリセットしますか？")&&(c=[],y())}),j.addEventListener("click",J),d.addEventListener("click",H),x.addEventListener("click",()=>{v.value&&(navigator.clipboard.writeText(v.value),alert("クリップボードにコピーしました。"))}),u.addEventListener("change",()=>{localStorage.setItem(w,u.value)}),p.addEventListener("change",()=>{localStorage.setItem(L,p.value)})};z();
