(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function e(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(o){if(o.ep)return;o.ep=!0;const r=e(o);fetch(o.href,r)}})();const B=["チャプター1","面白かったところ","重要なポイント","質問"],b="timestampLogs",h="youtubeApiKey",L="memoPatterns",I=document.getElementById("memo-patterns-list"),S=document.getElementById("new-memo-pattern-input"),O=document.getElementById("add-memo-pattern-button"),T=document.getElementById("memo-buttons-container"),A=document.getElementById("log-output"),$=document.getElementById("reset-button"),_=document.getElementById("youtube-url"),d=document.getElementById("api-key"),m=document.getElementById("convert-button"),l=document.getElementById("youtube-timestamps"),C=document.getElementById("copy-button");let a=[],i=[];const g=()=>{I.innerHTML="",i.forEach((t,n)=>{const e=document.createElement("div");e.className="memo-pattern-item",e.textContent=t;const s=document.createElement("button");s.textContent="×",s.addEventListener("click",()=>{K(n)}),e.appendChild(s),I.appendChild(e)})},w=()=>{localStorage.setItem(L,JSON.stringify(i))},N=()=>{const t=S.value.trim();t&&!i.includes(t)&&(i.push(t),w(),g(),f(),S.value="")},K=t=>{i.splice(t,1),w(),g(),f()},p=()=>{const t=e=>new Intl.DateTimeFormat("ja-JP",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1,timeZone:"Asia/Tokyo"}).format(new Date(e)),n=a.map(e=>`[${t(e.timestamp)}] ${e.memo}`).join(`
`);A.value=n,localStorage.setItem(b,JSON.stringify(a))},x=t=>{const n={timestamp:Date.now(),memo:t};a.push(n),a.sort((e,s)=>e.timestamp-s.timestamp),p()},f=()=>{T.innerHTML="",i.forEach(t=>{const n=document.createElement("button");n.textContent=t,n.addEventListener("click",()=>x(t)),T.appendChild(n)})},D=t=>{const n=/(?:youtube\.com\/(?:watch\?v=|embed\/|live\/)|youtu\.be\/)([a-zA-Z0-9_-]{11})/,e=t.match(n);return e?e[1]:null},R=t=>{const n=Math.floor(t/3600),e=Math.floor(t%3600/60),s=Math.floor(t%60),o=String(e).padStart(2,"0"),r=String(s).padStart(2,"0");return n>0?`${n}:${o}:${r}`:`${e}:${r}`},U=async()=>{var s;const t=_.value,n=d.value,e=D(t);if(!e){alert("有効なYouTubeのURLを入力してください。");return}if(!n){alert("YouTube Data APIキーを入力してください。");return}if(a.length===0){alert("記録されたタイムスタンプがありません。");return}try{m.textContent="変換中...",m.disabled=!0;const o=`https://www.googleapis.com/youtube/v3/videos?id=${e}&part=liveStreamingDetails&key=${n}`,r=await fetch(o),c=await r.json();if(!r.ok||c.items.length===0)throw new Error(((s=c.error)==null?void 0:s.message)||"動画情報の取得に失敗しました。");const u=c.items[0].liveStreamingDetails,y=u==null?void 0:u.actualStartTime;if(!y)throw new Error("ライブ配信の開始時刻が取得できませんでした。アーカイブ動画ではない可能性があります。");const P=new Date(y).getTime(),M=a.map(E=>{const v=(E.timestamp-P)/1e3;return`${v>0?R(v):"00:00"} ${E.memo}`});l.value=M.join(`
`)}catch(o){alert(`エラーが発生しました: ${o instanceof Error?o.message:String(o)}`)}finally{m.textContent="変換実行",m.disabled=!1}},Y=()=>{const t=localStorage.getItem(b);t&&(a=JSON.parse(t),p());const n=localStorage.getItem(h);n&&(d.value=n);const e=localStorage.getItem(L);e?i=JSON.parse(e):i=[...B],g(),f(),O.addEventListener("click",N),$.addEventListener("click",()=>{confirm("本当にすべてのログをリセットしますか？")&&(a=[],p())}),m.addEventListener("click",U),C.addEventListener("click",()=>{l.value&&(navigator.clipboard.writeText(l.value),alert("クリップボードにコピーしました。"))}),d.addEventListener("change",()=>{localStorage.setItem(h,d.value)})};Y();
