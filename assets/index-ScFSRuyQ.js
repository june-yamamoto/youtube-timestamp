(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function e(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(o){if(o.ep)return;o.ep=!0;const r=e(o);fetch(o.href,r)}})();const O=["チャプター1","面白かったところ","重要なポイント","質問"],w="timestampLogs",I="youtubeApiKey",P="memoPatterns",T=document.getElementById("memo-patterns-list"),b=document.getElementById("new-memo-pattern-input"),A=document.getElementById("add-memo-pattern-button"),L=document.getElementById("memo-buttons-container"),_=document.getElementById("log-output"),$=document.getElementById("reset-button"),C=document.getElementById("youtube-url"),d=document.getElementById("api-key"),m=document.getElementById("convert-button"),p=document.getElementById("youtube-timestamps"),N=document.getElementById("copy-button");let c=[],i=[];const f=()=>{T.innerHTML="",i.forEach((t,n)=>{const e=document.createElement("div");e.className="memo-pattern-item",e.textContent=t;const s=document.createElement("button");s.textContent="×",s.addEventListener("click",()=>{x(n)}),e.appendChild(s),T.appendChild(e)})},M=()=>{localStorage.setItem(P,JSON.stringify(i))},K=()=>{const t=b.value.trim();t&&!i.includes(t)&&(i.push(t),M(),f(),y(),b.value="")},x=t=>{i.splice(t,1),M(),f(),y()},g=()=>{const t=e=>new Intl.DateTimeFormat("ja-JP",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1,timeZone:"Asia/Tokyo"}).format(new Date(e)),n=c.map(e=>`[${t(e.timestamp)}] ${e.memo}`).join(`
`);_.value=n,localStorage.setItem(w,JSON.stringify(c))},D=t=>{const n={timestamp:Date.now(),memo:t};c.push(n),c.sort((e,s)=>e.timestamp-s.timestamp),g()},y=()=>{L.innerHTML="",i.forEach(t=>{const n=document.createElement("button");n.textContent=t,n.addEventListener("click",()=>D(t)),L.appendChild(n)})},R=t=>{const n=/(?:youtube\.com\/(?:watch\?v=|embed\/|live\/)|youtu\.be\/)([a-zA-Z0-9_-]{11})/,e=t.match(n);return e?e[1]:null},l=t=>{const n=Math.floor(t/3600),e=Math.floor(t%3600/60),s=Math.floor(t%60),o=String(n).padStart(2,"0"),r=String(e).padStart(2,"0"),a=String(s).padStart(2,"0");return`${o}:${r}:${a}`},U=async()=>{var s;const t=C.value,n=d.value,e=R(t);if(!e){alert("有効なYouTubeのURLを入力してください。");return}if(!n){alert("YouTube Data APIキーを入力してください。");return}try{m.textContent="変換中...",m.disabled=!0;const o=`https://www.googleapis.com/youtube/v3/videos?id=${e}&part=liveStreamingDetails&key=${n}`,r=await fetch(o),a=await r.json();if(!r.ok||a.items.length===0)throw new Error(((s=a.error)==null?void 0:s.message)||"動画情報の取得に失敗しました。");const u=a.items[0].liveStreamingDetails,E=u==null?void 0:u.actualStartTime;if(!E)throw new Error("ライブ配信の開始時刻が取得できませんでした。アーカイブ動画ではない可能性があります。");const B=new Date(E).getTime(),v=c.map(h=>{const S=(h.timestamp-B)/1e3;return`${S>0?l(S):l(0)} ${h.memo}`});v.unshift(`${l(0)} 配信開始`),p.value=v.join(`
`)}catch(o){alert(`エラーが発生しました: ${o instanceof Error?o.message:String(o)}`)}finally{m.textContent="変換実行",m.disabled=!1}},Y=()=>{const t=localStorage.getItem(w);t&&(c=JSON.parse(t),g());const n=localStorage.getItem(I);n&&(d.value=n);const e=localStorage.getItem(P);e?i=JSON.parse(e):i=[...O],f(),y(),A.addEventListener("click",K),$.addEventListener("click",()=>{confirm("本当にすべてのログをリセットしますか？")&&(c=[],g())}),m.addEventListener("click",U),N.addEventListener("click",()=>{p.value&&(navigator.clipboard.writeText(p.value),alert("クリップボードにコピーしました。"))}),d.addEventListener("change",()=>{localStorage.setItem(I,d.value)})};Y();
